<div
  class="min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 py-12 px-4 sm:px-6 lg:px-8"
>
  <div class="mx-auto">
    <div class="text-center mb-10">
      <h1
        class="text-3xl font-extrabold text-gray-900 dark:text-white sm:text-4xl"
      >
        Крипто Тикер
      </h1>
      <p
        class="mt-3 max-w-md mx-auto text-base text-gray-500 dark:text-gray-400 sm:text-lg"
      >
        Актуальные данные о курсах криптовалют в реальном времени
      </p>
    </div>

    <div
      class="crypto-table-container bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-100 p-6 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700"
    >
      <ng-container *ngIf="loading; else content">
        <div class="text-center my-6 flex items-center justify-center">
          <div
            class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mr-3"
          ></div>
          <span class="text-lg font-medium">Загрузка данных...</span>
        </div>
      </ng-container>
      <ng-template #content>
        <div class="filter-section flex flex-col md:flex-row gap-4 mb-6">
          <input
            type="text"
            placeholder="Фильтр по названию инструмента"
            [(ngModel)]="filterText"
            (input)="applyFilter()"
            class="flex-1 max-w-xs p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white transition-all duration-200"
          />
          <button
            (click)="sortByPrice()"
            class="p-3 px-5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition duration-300 shadow-md hover:shadow-lg flex items-center justify-center"
          >
            Сортировать по цене {{ sortAsc ? "▲" : "▼" }}
          </button>
        </div>

        <div class="mb-4">
          <p class="font-semibold">Текущее локальное время:</p>
          <span class="text-blue-600 dark:text-blue-400 font-medium">
            {{ currentDate | date : "dd MMM yyyy HH:mm:ss" }}
          </span>
        </div>

        <div
          class="table-scroll mt-4 overflow-auto max-h-[500px] rounded-lg border border-gray-200 dark:border-gray-700"
        >
          <table class="min-w-full border-collapse">
            <thead>
              <tr
                class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800"
              >
                <th
                  class="sticky top-0 px-6 py-3 text-left text-xs font-semibold uppercase tracking-wider bg-gray-100 dark:bg-gray-700 border-b border-gray-300 dark:border-gray-600"
                  title="Название инструмента"
                >
                  Инструмент
                </th>
                <th
                  class="sticky top-0 px-6 py-3 text-right text-xs font-semibold uppercase tracking-wider bg-gray-100 dark:bg-gray-700 border-b border-gray-300 dark:border-gray-600"
                  title="Текущая цена (округление до 4 знаков)"
                >
                  Цена
                </th>
                <th
                  class="sticky top-0 px-6 py-3 text-right text-xs font-semibold uppercase tracking-wider bg-gray-100 dark:bg-gray-700 border-b border-gray-300 dark:border-gray-600"
                  title="Объём торгов за 24 часа"
                >
                  Объём
                </th>
                <th
                  class="sticky top-0 px-6 py-3 text-right text-xs font-semibold uppercase tracking-wider bg-gray-100 dark:bg-gray-700 border-b border-gray-300 dark:border-gray-600"
                  title="Максимальная цена за сутки"
                >
                  High
                </th>
                <th
                  class="sticky top-0 px-6 py-3 text-right text-xs font-semibold uppercase tracking-wider bg-gray-100 dark:bg-gray-700 border-b border-gray-300 dark:border-gray-600"
                  title="Минимальная цена за сутки"
                >
                  Low
                </th>
                <th
                  class="sticky top-0 px-6 py-3 text-right text-xs font-semibold uppercase tracking-wider bg-gray-100 dark:bg-gray-700 border-b border-gray-300 dark:border-gray-600"
                  title="Процент изменения за сутки"
                >
                  Изм. (%)
                </th>
                <th
                  class="sticky top-0 px-6 py-3 text-right text-xs font-semibold uppercase tracking-wider bg-gray-100 dark:bg-gray-700 border-b border-gray-300 dark:border-gray-600"
                  title="Время биржи (наведите для более точного времени)"
                >
                  Время
                </th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-700">
              <tr
                *ngFor="let instrument of filteredInstruments"
                class="hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-150"
              >
                <td class="px-6 py-4 whitespace-nowrap font-medium">
                  {{ instrument.symbol }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right font-mono">
                  {{ formatPrice(instrument.price) }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right">
                  {{ formatVolume(instrument.volume) }}
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-right font-mono text-green-600 dark:text-green-400"
                >
                  {{ formatPrice(instrument.high) }}
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-right font-mono text-red-600 dark:text-red-400"
                >
                  {{ formatPrice(instrument.low) }}
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-right font-medium"
                  [ngClass]="{
                    'text-green-600 dark:text-green-400':
                      instrument.changePercent >= 0,
                    'text-red-600 dark:text-red-400':
                      instrument.changePercent < 0
                  }"
                >
                  {{ instrument.changePercent.toFixed(2) }}%
                </td>
                <td
                  class="px-6 py-4 whitespace-nowrap text-right text-gray-500 dark:text-gray-400"
                  [title]="getServerTimeString(instrument)"
                >
                  {{ getLocalTimeString(instrument) }}
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </ng-template>
    </div>
  </div>
</div>
